const LOCAL_STORAGE_WISHLIST_KEY="shopify-wishlist",LOCAL_STORAGE_DELIMITER=",",BUTTON_ACTIVE_CLASS="active",GRID_LOADED_CLASS="loaded",selectors={button:"[button-wishlist]",grid:"[grid-wishlist]",productCard:".product-card"};document.addEventListener("DOMContentLoaded",()=>{initButtons();initGrid()});document.addEventListener("shopify-wishlist:updated",a=>{console.log("[Shopify Wishlist] Wishlist Updated \u2705",a.detail.wishlist);initGrid()});
document.addEventListener("shopify-wishlist:init-product-grid",a=>{console.log("[Shopify Wishlist] Wishlist Product List Loaded \u2705",a.detail.wishlist)});document.addEventListener("shopify-wishlist:init-buttons",a=>{console.log("[Shopify Wishlist] Wishlist Buttons Loaded \u2705",a.detail.wishlist)});
const fetchProductCardHTML=a=>fetch(`/products/${a}?view=card`).then(b=>b.text()).then(b=>(new DOMParser).parseFromString(b,"text/html").documentElement.querySelector(selectors.productCard).outerHTML).catch(b=>console.error(`[Shopify Wishlist] Failed to load content for handle: ${a}`,b)),setupGrid=async a=>{const b=getWishlist();if(0===b.length)a.innerHTML='<p style="text-align: center; color: #FF9900; font-weight: 600;">Your wishlist is empty.</p>',a.classList.remove(GRID_LOADED_CLASS),initButtons();
else{var c=b.map(fetchProductCardHTML);c=(await Promise.all(c)).join("");a.innerHTML=c;a.classList.add(GRID_LOADED_CLASS);initButtons();a=new CustomEvent("shopify-wishlist:init-product-grid",{detail:{wishlist:b}});document.dispatchEvent(a)}},setupButtons=a=>{a.forEach(b=>{const c=b.dataset.productHandle||!1;if(!c)return console.error("[Shopify Wishlist] Missing `data-product-handle` attribute. Failed to update the wishlist.");wishlistContains(c)&&b.classList.add(BUTTON_ACTIVE_CLASS);b.addEventListener("click",
()=>{updateWishlist(c);b.classList.toggle(BUTTON_ACTIVE_CLASS)})})},initGrid=()=>{const a=document.querySelector(selectors.grid)||!1;a&&setupGrid(a)},initButtons=()=>{var a=document.querySelectorAll(selectors.button)||[];a.length&&setupButtons(a);a=new CustomEvent("shopify-wishlist:init-buttons",{detail:{wishlist:getWishlist()}});document.dispatchEvent(a)},getWishlist=()=>{const a=localStorage.getItem(LOCAL_STORAGE_WISHLIST_KEY)||!1;return a?a.split(LOCAL_STORAGE_DELIMITER):[]},setWishlist=a=>{const b=
a.join(LOCAL_STORAGE_DELIMITER);a.length?localStorage.setItem(LOCAL_STORAGE_WISHLIST_KEY,b):localStorage.removeItem(LOCAL_STORAGE_WISHLIST_KEY);a=new CustomEvent("shopify-wishlist:updated",{detail:{wishlist:a}});document.dispatchEvent(a);return b},updateWishlist=a=>{const b=getWishlist(),c=b.indexOf(a);-1===c?b.push(a):b.splice(c,1);return setWishlist(b)},wishlistContains=a=>getWishlist().includes(a),resetWishlist=()=>setWishlist([]);
